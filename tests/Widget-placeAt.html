<!DOCTYPE html>
<html>
<head>

	<meta http-equiv="Content-type" content="text/html; charset=utf-8">

	<title>_Widget.placeAt tests</title>

	<script src="boilerplate.js"></script>

	<script type="text/javascript">
		require([
			"doh/runner", "dojo/aspect", "dojo/dom",
			"dui/register", "dui/Widget", "dui/Button",
			"dojo/domReady!"
		], function (doh, aspect, dom, register, Widget, Button) {

			var SimpleWidget = register("simple-widget", [HTMLElement, Widget], {
				buildRendering: function () {
					this.containerNode = document.createElement("div");
					this.appendChild(this.containerNode);
				}
			});

			var simple, pane1, pane2, pane3, pane4;
			doh.register("parent without addChild", [
				function placeAChild() {
					// create a SimpleWidget
					simple = (new SimpleWidget({id: "simple"})).placeAt("container");
					doh.is(dom.byId("container"), simple.parentNode, "simple is child of container");
				},

				function placeAsWidgetChild() {
					// add the child to the SimpleWidget now
					pane1 = (new SimpleWidget({ title: "pane1" })).placeAt(simple);
					doh.is(pane1, simple.getChildren()[0], "pane1 is child of SimpleWidget");
					doh.is(simple.containerNode, pane1.parentNode, "pane1 added to simple.containerNode not simple");
				},

				function placeAsWidgetChildOrdered() {
					// add this child (created second) as the new first child
					pane2 = (new SimpleWidget({ title: "pane2" })).placeAt("simple", 0);
					doh.is(simple.containerNode, pane2.parentNode, "pane2 added to simple.containerNode not simple");
					doh.is(pane2, simple.getChildren()[0], "pane2 is new first child of SimpleWidget");
					doh.is(pane1, simple.getChildren()[1], "pane1 is now second child of SimpleWidget");
				},

				function placeBefore() {
					var button = (new Button({})).placeAt(dom.byId("container"), "before");
					doh.is(dom.byId("container"), button.nextSibling, "button is before tab container");
				},

				function placeBeforeId() {
					var button = (new Button({})).placeAt("container", "before");
					doh.is(dom.byId("container"), button.nextSibling, "button is before tab container");
				},

				function placeFirstWidget() {
					simple.startup();
					pane3 = (new SimpleWidget({ title: "pane3" })).placeAt("simple", "first");
					doh.is(simple.containerNode, pane3.parentNode, "pane3 added to simple.containerNode not simple")
					doh.is(pane3, simple.getChildren()[0], "pane3 is new first child of SimpleWidget");
					doh.t(pane3._started, "pane3 was automatically started because simple was already started")
				},
				function placeLastWidget() {
					pane4 = (new SimpleWidget({ title: "pane4" })).placeAt(simple.containerNode, "last");
					doh.is(pane4, simple.getChildren()[simple.getChildren().length - 1], "pane4 is new last child of SimpleWidget");
					doh.t(pane4._started, "pane4 was automatically started because simple was already started")
				}
			]);

			doh.run();
		});
	</script>
</head>
<body class="claro">
<h1 class="testTitle">_Widget.placeAt tests</h1>

<div id="container">
</div>
</body>
</html>
